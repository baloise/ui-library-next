<!DOCTYPE html>
<html dir="ltr" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=5.0" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <link rel="stylesheet" href="/build/ui-library-next.css" />
    <script type="module" src="/build/ui-library-next.esm.js"></script>
    <script nomodule src="/build/ui-library-next.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/lodash@4.17.20/lodash.min.js"></script>
  </head>
  <body class="bal-app">
    <div class="container">
      <h2 class="title is-size-2">Basic</h2>
      <section>
        <bal-select id="bal-select-year" placeholder="select a year">
          <bal-select-option value="1995" label="1995">1995</bal-select-option>
          <bal-select-option value="1996" label="1996">1996</bal-select-option>
          <bal-select-option value="1997" label="1997">1997</bal-select-option>
          <bal-select-option value="1998" label="1998">1998</bal-select-option>
          <bal-select-option value="1999" label="1999">1999</bal-select-option>
          <bal-select-option value="2000" label="2000">2000</bal-select-option>
        </bal-select>
        <bal-select id="bal-select-year-disabled" disabled placeholder="disabled"></bal-select>

        <bal-button id="bal-select-year-clear">Clear</bal-button>
      </section>
      <script>
        var selectYear = document.getElementById('bal-select-year')
        var buttonYear = document.getElementById('bal-select-year-clear')
        buttonYear.addEventListener('click', function () {
          selectYear.clear()
        })
      </script>

      <h3 class="title is-size-3">Styling</h3>
      <section>
        <div class="has-background-blue is-padded">
          <bal-select inverted expanded placeholder="select a hero">
            <bal-select-option value="1" label="Ant-Man">
              <b style="display: block">Ant-Man</b>
              <span>San Francisco</span>
            </bal-select-option>
            <bal-select-option value="2" label="Spider-Man">
              <b style="display: block">The amating Spider-Man The amating Spider-Man The amating Spider-Man</b>
              <span>Queens</span>
            </bal-select-option>
            <bal-select-option value="3" label="Iron Man">
              <b style="display: block">Iron Man</b>
              <span>Malibu</span>
            </bal-select-option>
            <bal-select-option value="4" label="Black Panter">
              <b style="display: block">Black Panter</b>
              <span>Wakanda</span>
            </bal-select-option>
          </bal-select>
        </div>
      </section>

      <h2 class="title is-size-2">Multi-Select</h2>
      <section>
        <bal-select multiple placeholder="select a hero">
          <bal-select-option checkbox value="1" label="Ant-Man">
            <b style="display: block">Ant-Man</b>
            <span>San Francisco</span>
          </bal-select-option>
          <bal-select-option checkbox value="2" label="Spider-Man">
            <b style="display: block">The amating Spider-Man The amating Spider-Man The amating Spider-Man</b>
            <span>Queens</span>
          </bal-select-option>
          <bal-select-option checkbox value="3" label="Iron Man">
            <b style="display: block">Iron Man</b>
            <span>Malibu</span>
          </bal-select-option>
          <bal-select-option checkbox value="4" label="Black Panter">
            <b style="display: block">Black Panter</b>
            <span>Wakanda</span>
          </bal-select-option>
        </bal-select>
      </section>

      <h2 class="title is-size-2">Typeahead</h2>
      <h3 class="title is-size-3">Single</h3>
      <section>
        <bal-select typeahead placeholder="select a hero">
          <bal-select-option value="1" label="Ant-Man">
            <b style="display: block">Ant-Man</b>
            <span>San Francisco</span>
          </bal-select-option>
          <bal-select-option value="2" label="Spider-Man">
            <b style="display: block">The amating Spider-Man The amating Spider-Man The amating Spider-Man</b>
            <span>Queens</span>
          </bal-select-option>
          <bal-select-option value="3" label="Iron Man">
            <b style="display: block">Iron Man</b>
            <span>Malibu</span>
          </bal-select-option>
          <bal-select-option value="4" label="Black Panter">
            <b style="display: block">Black Panter</b>
            <span>Wakanda</span>
          </bal-select-option>
        </bal-select>
      </section>

      <h3 class="title is-size-3">Multiple</h3>
      <section>
        <bal-select typeahead multiple placeholder="select a hero" filter-placeholder="search your hero">
          <bal-select-option checkbox value="1" label="Ant-Man">
            <b style="display: block">Ant-Man</b>
            <span>San Francisco</span>
          </bal-select-option>
          <bal-select-option checkbox value="2" label="Spider-Man">
            <b style="display: block">The amating Spider-Man The amating Spider-Man The amating Spider-Man</b>
            <span>Queens</span>
          </bal-select-option>
          <bal-select-option checkbox value="3" label="Iron Man">
            <b style="display: block">Iron Man</b>
            <span>Malibu</span>
          </bal-select-option>
          <bal-select-option checkbox value="4" label="Black Panter">
            <b style="display: block">Black Panter</b>
            <span>Wakanda</span>
          </bal-select-option>
        </bal-select>
      </section>

      <h3 class="title is-size-3">No Filter</h3>
      <section>
        <bal-field id="bal-select-typeahead-remote-field" label="Star Wars Character" is-expanded>
          <bal-select
            id="bal-select-typeahead-remote"
            typeahead
            no-filter
            placeholder="start typing"
            expanded
          ></bal-select>
        </bal-field>
        <p class="help" id="bal-select-typeahead-remote-help"></p>
      </section>
      <script>
        const selectTypeaheadRemote = document.getElementById('bal-select-typeahead-remote')
        const selectTypeaheadRemoteField = document.getElementById('bal-select-typeahead-remote-field')
        const selectTypeaheadRemoteHelp = document.getElementById('bal-select-typeahead-remote-help')

        const searchFunction = event => {
          const search = event.detail
          selectTypeaheadRemote.loading = true
          selectTypeaheadRemoteField.loading = true
          fetch('https://swapi.dev/api/people/?search=' + search)
            .then(res => res.json())
            .then(data => {
              selectTypeaheadRemote.querySelectorAll('bal-select-option').forEach(function (element) {
                element.parentNode.removeChild(element)
              })
              data.results.forEach(person => {
                var option = document.createElement('bal-select-option')
                option.setAttribute('value', person.url)
                option.setAttribute('label', person.name)
                option.innerHTML = person.name
                selectTypeaheadRemote.querySelector('.dropdown-content').appendChild(option)
              })
              selectTypeaheadRemote.loading = false
              selectTypeaheadRemoteField.loading = false
            })
        }

        const debounce = (func, wait) => {
          let timeout = undefined
          return function () {
            const context = this
            const args = arguments

            const later = () => {
              timeout = null
              func.apply(context, args)
            }

            clearTimeout(timeout)
            timeout = setTimeout(later, wait)

            if (!timeout) func.apply(context, args)
          }
        }

        const handleInput = debounce(searchFunction, 1000)

        selectTypeaheadRemote.addEventListener('balChange', function (event) {
          selectTypeaheadRemoteHelp.innerHTML = event.detail
        })

        selectTypeaheadRemote.addEventListener('balInput', function (event) {
          selectTypeaheadRemote.addEventListener('balInput', handleInput)
        })
      </script>
    </div>
  </body>
</html>
